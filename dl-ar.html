<HTML>
<HEAD>
 <style>
body p {font-size:20px; font-family: "Georgia", serif;}
body pre {font-size:15px;}
body { 
	background-image: url('fon.jpg');
	background-attachment:fixed;	
	color: #000;
	 }
body BLOCKQUOTE { 
    padding: 20px;
    background: #E0FFFF;
    border: 2px solid #4B0082;
   }
 body hr {
	border: 0;
	height: 1px;
	background: #000;
	background-image: -webkit-linear-gradient(left, #fff, #000, #fff);
	background-image: -moz-linear-gradient(left, #fff, #000, #fff);
	background-image: -ms-linear-gradient(left, #fff, #000, #fff);
	background-image: -o-linear-gradient(left, #fff, #000, #fff);
		}
body table {
    width: 40%; /* Ширина таблицы */
    background: white; /* Цвет фона таблицы */
    color: black; /* Цвет текста */
    border-spacing: 1px; /* Расстояние между ячейками */
	border: 2px solid #00008B;
	border-collapse: collapse;
	font-family: "Calibri", sans-serif;
	font-size: 17px;
	}
   td, tr {
    padding: 5px; /* Поля вокруг текста */
	border: 1px solid black;
	}
	td { width: 60%;}
</style>
  <title>Задачи на длинную арифметику.</title>
</HEAD>
<body rightmargin="30" leftmargin="30"> 
<p align="right"><i><font size="3">Шестаков А.П.</font></i>&nbsp;</p>
<CENTER>
<hr>
</center><br>
<center><h1>ЗАДАЧИ НА ДЛИННУЮ АРИФМЕТИКУ</h1></center><br>
<CENTER>
<hr>
</center>
 <META name="keywords" 
content="Задачи, длинная арифметика, программирование, астронамические числа">
 <meta name="description" 
content="Тренировка в программировании и практика в решении задач с длинными числами">
<img src="https://xvp.akamaized.net/assets/illustrations/did-you-know-2155862aa271f3ead64f2e377c9f17be.png" align="right" width="240" 
height="240" hspace="200" vspace="5"/>
<font size="+1"><h2 align=”left”>Оглавление:</h2></font>
<font size="+2" face="Georgia"><OL>
<LI><a href="#vvedenie">Введение</a></LI>
<LI><a href="#primer">Пример</a></LI>
<LI><a href="#zadachi">Задачи для самостоятельного решения</a></LI>
<LI><a href="#tabl">Таблица</a></LI>
<LI><a href="#spisok">Список использованной литературы</a></LI>
<LI><a href="#staty">Похожие статьи</a></LI>
</OL></font>
<CENTER>
<hr>
</center>
<font size="+1"><a id="vvedenie"><h2 align=”left”>Введение:</h2></a></font>
<p>Рассмотрим достаточно популярную в программировании задачу на работу с "длинными" числами. Реально с "астрономическими" или "микроскопическими" числами приходится сталкиваться не так уж и часто. Тем не менее, упражнения, рассматриваемые в этой публикации, могут послужить хорошей тренировкой в области программирования и занять достойное место в классах с углубленным изучением информатики или на кружках по программированию. Алгоритмы, представленные ниже, записаны на Turbo Pascal, версия&nbsp;7.0. При желании или необходимости они могут легко быть адаптированы к любой другой программной среде.</p>
<P>Диапазон представления целых чисел
(<B>Integer, Word, LongInt</B>) ограничен, о чем не раз уже говорилось (впрочем, для действительных
величин это замечание тоже актуально). Поэтому при решении задач
всегда приходится действовать с оглядкой, — как бы не допустить
возникновения ошибки выхода за диапазон или переполнения. Например,
вычисляя факториал (<I>n</I>!&nbsp;=&nbsp;1&nbsp;*&nbsp;2&nbsp;*&nbsp;3&nbsp;*&nbsp;…&nbsp;*&nbsp;<I>n</I>),
в диапазоне представления величин типа <FONT FACE = "Courier">Integer</FONT>
удастся правильно получить только 7!&nbsp;=&nbsp;5040, а в
диапазоне представления типа <FONT FACE = "Courier">LongInt</FONT> —
12!&nbsp;=&nbsp;479001600. Для больших значений, конечно, можно использовать действительные типы данных, но это уже не гарантирует точного результата. Поэтому полезно для получения точных значений при действиях с многозначными числами разработать другие способы представления таких чисел, алгоритмы выполнения арифметических и других операций, процедуры ввода и вывода результатов и т.д. </P>
<CENTER>
<hr>
</center>
<font size="+1"><a id="primer"><h3 align=”left”>Пример:</h3></a></font>
<P>Покажем реализацию решения такого рода задач на примере умножения одного многозначного числа на другое. Именно эта арифметическая операция наиболее часто используется при решении других задач.</P>
<P>Наиболее естественным способом представления многозначного числа является запись каждого его разряда в виде отдельного элемента линейного массива (или списка, где память под цифру будет отводиться по мере надобности, в то время как в массиве приходится заранее задавать максимальное количество элементов в нем). Пусть (для удобства дальнейших действий) разряды "длинного" числа при записи в массив нумеруются с единицы, начиная с разряда единиц, т.е. цифра из разряда единиц — элемент массива с номером один, цифра из разряда десятков — элемент массива с номером два и т.д. Определим для работы с "длинными" неотрицательными числами тип данных:</P>
<PRE>          
          Const MNax = 2000;
          Type Digit = 0..9;
               DlChislo = Array[1..Nmax] Of Digit;
</PRE>
<P ALIGN=JUSTIFY>Для решения поставленной задачи необходимо уметь выполнять следующие действия:</P>
<font size="+1" face="Georgia">
<OL>
<LI> ввод "длинного" числа;
<LI> собственно умножение двух "длинных" чисел;
<LI> вывод "длинного" числа;
<LI> определение количества цифр в записи числа.</OL>
</font>
<P>Каждую из подзадач реализуем в виде отдельной подпрограммы. Начнем с ввода. Ввести большое число целесообразно в виде строки, а в дальнейшем преобразовать в массив цифр. В процедуре учтен указанный выше способ размещения "длинного" числа в массиве, т.е. с точки зрения пользователя число записывается как бы в обратном порядке.</P>
<BLOCKQUOTE><PRE>
{Процедура преобразования длинного числа, записанного
 в виде строки, в массив цифр; переменная OK принимает значение True,
 если в записи числа нет посторонних символов, отличных от десятичных
 цифр, иначе — false}
 Procedure Translate(S : String; Var A : DlChislo; Var OK : Boolean);
 Var I : Word;
 Begin
     Zero(A); I := Length(S); OK := True;
     While (I >= 1) And OK Do
      Begin
          If S[I] In ['0'..'9']
          Then A[Length(S)- I + 1]:= Ord(S[I]) - 48
          Else OK := False; I := I - 1
      End
 End;
</PRE></BLOCKQUOTE>
<P>В процедуре вызывается подпрограмма <FONT FACE="Courier">Zero(A)</FONT>, назначение которой — запись нуля в каждый разряд длинного числа. Вот текст этой процедуры:</P>
<BLOCKQUOTE><PRE>
 {Процедура обнуления длинного числа}
 Procedure Zero(Var A : DlChislo);
 Var I : Integer;
  Begin
    For I := 1 To NMax Do A[I] := 0;
  End;
</PRE></BLOCKQUOTE>
<P>Таким образом, длинное число записано в массив, где впереди (в качестве элементов с большими номерами) стоят незначащие нули. При выполнении действий и выводе ответа они не учитываются.</P>
<P>Сейчас разработаем функцию определения количества значащих цифр в записи числа, поскольку она потребуется при реализации подпрограммы умножения.</P>
<BLOCKQUOTE><PRE>
 {Функция определения количества цифр в записи длинного числа}
 Function Dlina(C : DlChislo) : Integer;
 Var I : Integer;
 Begin
   I := NMax;
   While (I > 1) And (C[I] = 0) Do I := I - 1;
   Dlina := I
 End;
</PRE></BLOCKQUOTE>
<P>При ее разработке было использовано следующее соображение: если число не равно нулю, то количество цифр в его записи равно номеру первой цифры, отличной от нуля, если просмотр числа осуществляется от старшего разряда к младшему. Если же длинное число равно нулю, то получается, что количество цифр в его записи равно одной, что и требовалось.</P>
<P>Ну и, наконец, главная процедура, ради которой и была проделана вся предшествующая работа. При составлении алгоритма используется идея умножения "столбиком", хотя в нашем варианте сложение выполняется не по окончанию умножения, а по ходу его, т.е. перемножив очередные цифры, сразу же добавляем результирующую цифру в нужный разряд и формируем перенос в следующий разряд.</P>
<BLOCKQUOTE><PRE>
{Процедура умножения длинных чисел.
 A, B — множители, C — произведение}
 Procedure Multiplication(A, B : DlChislo; Var C : DlChislo);
 Var I, J : Integer; P : Digit; VspRez : 0..99;
  Begin
    Zero(C);
    For I := 1 To Dlina(A) Do {Цикл по количеству цифр
                               в первом числе}
     Begin
        P := 0; {Первоначально перенос равен нулю}
        For J := 1 To Dlina(B) Do {Цикл по количеству цифр
                                   во втором числе}
         Begin
           VspRez := A[I] * B[J] + P + C[I + J - 1];
           C[I + J - 1] := VspRez Mod 10; {Очередное значение цифры в
                                           разряде I + J - 1}
           P := VspRez Div 10 {Перенос в следующий разряд}
         End;
       C[I + J] := P {последний перенос может быть отличен от нуля,
                      запишем его в пока ещё свободный разряд}
     End
  End;
</PRE></BLOCKQUOTE>
<P>Сейчас приведем листинг программы целиком.</P>
<BLOCKQUOTE><PRE>
Program DlUmn;
Const NMax = 2000;
Type Digit = 0..9; DlChislo = Array[1..Nmax] Of Digit;
Var S : String;
    M, N, R, F : DlChislo;
    I, MaxF : Word;
    Logic : Boolean;
{Процедура обнуления длинного числа}
Procedure Zero(Var A : DlChislo);
Var I : Integer;
  Begin
    For I := 1 To NMax Do A[I] := 0;
  End;
{Функция определения количества цифр в записи длинного числа}
Function Dlina(C : DlChislo) : Integer;
Var I : Integer;
 Begin
   I := NMax;
   While (I > 1) And (C[I] = 0) Do I := I - 1;
   Dlina := I
 End;
{Процедура печати длинного числа}
Procedure Print(A : DlChislo);
Var I : Integer;
 Begin
    For I := Dlina(A) DownTo 1 Do Write(A[I] : 1);
    WriteLn
 End;
{Процедура преобразования длинного числа в массив цифр}
Procedure Translate(S : String; Var A : DlChislo;
                    Var OK : Boolean);
Var I : Word;
 Begin
   Zero(A); I := Length(S); OK := True;
   While (I >= 1) And OK Do
   Begin
      If S[I] In ['0'..'9']
      Then A[Length(S) - I+ 1] := Ord(S[I]) - 48
      Else OK := False;
      I := I - 1
   End
 End;
Procedure Multiplication(A, B : DlChislo; Var C : DlChislo);
Var I, J : Integer; P : Digit; VspRez : 0..99;
 Begin
  Zero(C);
  For I := 1 To Dlina(A) Do
  Begin P := 0;
        For J := 1 To Dlina(B) Do
        Begin
          VspRez := A[I] * B[J] + P + C[I + J - 1];
	    C[I + J - 1] := VspRez Mod 10;
	    P := VspRez Div 10
	  End;
        C[I + J] := P
   End
 End;
{Основная программа}
Begin
   Repeat {повторяем ввод, пока число не будет введено правильно}
     Write('Введите первый множитель: ');
     ReadLn(S); Translate(S, M, Logic)
   Until Logic;
   Repeat
     Write('Введите второй множитель: ');
     ReadLn(S); Translate(S, N, Logic)
   Until Logic;
   Multiplication(M, N, R); Print(R)
End.
</PRE></BLOCKQUOTE>
<P>В приведенном листинге <B>Print</B> — процедура вывода длинного числа. Предоставим читателю самостоятельно разобраться в алгоритме ее работы.</P>
<P>Вернемся к вычислению факториала. Используя разработанные подпрограммы, определим, значение факториала какого максимального числа можно разместить в памяти при таком представлении длинных чисел.</P>
<P>Вот измененный фрагмент основной программы, решающий поставленную задачу.</P>
<BLOCKQUOTE><PRE>
  Begin
    MaxF := 810;
    Zero(F);
    F[1] := 1;
    For I := 1 To MaxF Do
     Begin
       Str(I, S); {преобразование числа I к строковому типу S}
       Translate(S, M, Logic);
       Multiplication(F, M, F);
       Print(F);
       WriteLn('Факториал числа ', I : 4, ' содержит ', Dlina(F), ' цифр.')
     End
   End.
</PRE></BLOCKQUOTE>
<P>Расчеты показали, что можно вычислять факториалы до значения 810! включительно, в записи которого 1999 цифр. Далее вновь возникает переполнение. Расчеты по программе продолжаются около 5 минут (IBM PC с процессором Pentium–100).</P>
<P>Ниже будет предложен список задач для самостоятельного выполнения. Из них, по мнению автора, наибольшую сложность представляют реализации алгоритмов деления одного длинного числа на другое и извлечение квадратного корня. Алгоритм извлечения квадратного корня подробно описан в справочнике В.А. Гусева и А.Г. Мордковича [7]. В некоторых случаях составленные программы могут выступать как подпрограммы при разработке алгоритмов решения других, более сложных (как в примере с факториалом), задач. Кроме авторских задач и задач из списка литературы здесь приведены задания из олимпиад школьников по программированию, проводившихся в Пермской области в 1989-99&nbsp;гг.</P>
<CENTER>
<hr>
</center>
<center><h2>Музыкальная заминка:<h2></center>
<p>Никколо Паганини "Caprice No. 24":</p>
<audio controls autoplay loop="loop" style="width:600px"> 
<source src="НикколоПаганини.mp3" type="audio/mpeg">
</audio>
<CENTER>
<hr>
</center>
<a id="zadachi"><h2>Задачи для самостоятельного решения</h2></a>
<OL>
<LI>Составить программу сравнения двух многозначных чисел (количество знаков в записи чисел более&nbsp;20).</LI>
<LI>Составить программу, суммирующую два натуральных многозначных числа с количеством знаков более&nbsp;20.</LI>
<LI>Составить программу вычисления степени <I>a<SUP>n</I></SUP>, если <I>a</I> &gt; MaxInt, <I>n</I>&nbsp;&gt;&nbsp;10.</LI>
<LI>Составить программу вычисления числа 2<SUP>64</SUP> – 1, в результате сохранить все цифры.</LI>
<LI>Составить программу вычисления 100!.</LI>
<LI>Составить программу извлечения точного квадратного корня из <I>n</I>-разрядного числа (<I>n&nbsp;</I>&gt;&nbsp;40).</LI>
<LI>Составить программу вычисления точного значения <I>n</I>!, где <I>n</I> &gt; 12.</LI>
<LI>Составить программу вычисления точного значения <I>n<SUP>n</I></SUP>, где <I>n</I> &gt; 10.</LI>
<LI>Составить программу деления числа <I>a</I> на число <I>b</I>, если <I>a, b</I> — многозначные числа.</LI>
<LI>Вычислить 100! + 2<SUP>100</SUP>.</LI>
<LI>Вычислить 100! – 2<SUP>100</SUP>.</LI>
<LI>Вычислить 7<SUP>123</SUP>.</LI>
<LI>Встречаются ли среди цифр числа 2<SUP>11213</SUP> – 1 две подряд идущие девятки?</LI>
<LI>Вычислить 2<SUP>–200</SUP>.</LI>
<LI>Составить программу нахождения частного и остатка от деления <I>m</I>-значного числа на <I>n</I>–значное (<I>m, n</I> &gt; 20).</LI>
<LI>Выяснить, какое из чисел <I>a<SUP>m</I></SUP>, <I>b<SUP>n</I></SUP> больше и на сколько (<I>a, b</I>&nbsp;&lt;=&nbsp;40000; <I>m</I>, <I>n</I>&nbsp;&lt;=&nbsp;10).</LI>
<LI>Найти <I>n</I> знаков в десятичной записи
квадратного корня из целого числа <I>m</I> (<I>n</I> >= 50).</LI>
<LI>Найти количество делителей <I>n</I>-значного натурального числа (<I>n</I> &gt; 20).</LI>
<LI>Вычислить точное значение (<I>n</I>!)! (<I>n</I>&nbsp;&gt;=&nbsp;3).</LI>
<LI>Составить программу вычисления точного значения суммы 1! + 2! + 3! + ... + <I>n</I>! при <I>n&nbsp;</I>&gt;&nbsp;10.</LI>
<P ALIGN="CENTER"><LI>Составить программу вычисления точного значения суммы дробей  <IMG SRC="Image11.gif">  при <I>n</I> &gt; 10. </LI><Br>
Ответ должен быть представлен в виде несократимой дроби <I>P</I> / <I>Q</I>, где <I>P</I>, <I>Q</I> — натуральные числа.</P>
<LI>Вычислить точное значение (<I>n<SUP>n</I></SUP>)! при <I>n</I>&nbsp;&gt;=&nbsp;3.</LI>
<LI>Составить программу вычисления точного значения суммы первых <I>n</I> членов последовательности 1, <I>k</I>, <I>k</I><SUP>2</SUP>, <I>k</I><SUP>3</SUP>, ..., <I>k<SUP>n</SUP></I> (<I>n</I> &gt; MaxInt). <U>Указание: </U>используйте формулу суммы <I>n</I> членов геометрической прогрессии.</LI>
<LI>Составить программу вычисления точного значения суммы первых <I>n</I> членов последовательности чисел, кратных данному натуральному числу <I>k</I> (<I>n&nbsp;</I>&gt;&nbsp;MaxInt). <U>Указание: </U>используйте формулу суммы <I>n</I> членов арифметической прогрессии.</LI>
<LI>Вычислить точное значение суммы 1<SUP>2 </SUP>+ 2<SUP>2 </SUP>+ 3<SUP>2 </SUP>+ … + <I>n</I><SUP>2</SUP> (<I>n</I>&nbsp;&gt;=&nbsp;20000).</LI>
<LI>Вычислить точное значение суммы 1<sup><i>n</i></sup> + 2<sup><i>n</i></sup> + 3<sup><i>n</i></sup> + ... + <i>n</i><sup><i>n</i></sup> (<I>n</I>&nbsp;&gt;=&nbsp;10).</LI>
<LI>Найти первое простое число, которое больше 10<SUP>11</SUP>.</LI>
<LI>Составить программу вычисления точного значения многочлена
<I>a<sub>n</sub>x<sup>n</sup></i> + <I>a<sub>n</I> - 1</sub><I>x<sup>n</I> - 1</sup> + ...
+ <I>a</I><sub>1</sub><I>x</I> + <I>a</I><sub>0</sub>,
где <I>a<SUB>i</I></SUB>&nbsp;и&nbsp;<I>x</I> — целые числа больше 10<SUP>11</SUP>.</LI>
<LI>Найти наибольший общий делитель и наименьшее общее кратное чисел <I>m</I> и <I>n</I> (<I>m, n</I>&nbsp;&gt;=&nbsp;10<SUP>11</SUP>).</LI>
<LI>Проверить, являются ли числа <I>m</I> и <I>n</I> (<I>m, n</I>&nbsp;>=&nbsp;10<SUP>11</SUP>) взаимно простыми.</LI>
<LI>Докажите, что число 2<SUP>19936</SUP> * (2<SUP>19937</SUP> – 1) является совершенным, т.е. равно сумме всех своих делителей, кроме самого себя.</LI>
<LI>"<I>Вращающееся число"</I>. Написать программу, которая находит число, обладающее следующими свойствами:<Br>
1) число оканчивается на 5;<Br>
2) при умножении его на 5 образуется новое число, которое может быть получено из исходного вычеркиванием цифры 5 на конце и переписыванием ее в начало числа.</LI></P>
<LI>Дана последовательность, заданная рекуррентной формулой
<I>a</I><SUB><I>n</I> + 1</SUB> = 7<I>a<SUB>n</SUB></I> mod 2023, <I>a</I><SUB>1</SUB> = 1,
где <I>x</I> mod <I>y</I> означает остаток от деления <I>x</I> на <I>y</I>. Написать программу, вычисляющую <I>a<SUB>n</SUB></I> при 1&nbsp;&lt;=&nbsp;<I>n</I>&nbsp;&lt;=&nbsp;1000000000000000000000.</P>

<LI>Дана последовательность: 
<IMG SRC="Image15.gif" WIDTH=220 HEIGHT=52>
<P style="font-size: 16px">Написать программу, находящую точное значение <I>a<SUB>n</SUB></I> при 1&nbsp;&lt;=&nbsp;<I>n</I>&nbsp;&lt;=&nbsp;150.</P>
<P style="font-size: 16px">Пример. При <I>n</I> = 58 получаем <I>a<SUB>n</SUB></I> = 10359022039470231387111424.</P>
<LI> Напишите программу перевода многозначного числа (с количеством знаков больше 20) в системы счисления с основанием два, восемь, шестнадцать.</P>
<LI> Разложить на простые множители натуральное число с количеством знаков более 11.</P>
<LI><I> Умножение периодической дроби.</I> Задана некоторая положительная правильная периодическая дробь <I>Q</I> и натуральное число <I>N</I>. Числа<I> Q</I> и <I>N</I> таковы, что количество цифр, используемых для их описания, не превосходит 100. При изображении дроби <I>Q</I> периодическая часть заключается в круглые скобки.</P> 
<P style="font-size: 16px">Требуется написать программу, которая определяет результат умножения <I>Q</I> на <I>N</I>, то есть непериодическую часть и минимальный период числа <I>Q</I>&nbsp;*&nbsp;<I>N</I>.</P>
<P style="font-size: 16px">В случае получения результата умножения в виде конечной дроби скобки опускаются.</P></OL>
<P style="font-size: 16px"><U> Пример работы правильной программы</U><Br>
 Введите периодическую дробь: 0.1(6)<Br>
 Введите натуральное число: 2<Br>
 Ответ: 0.(3)</P>
<CENTER>
<hr>
</center>
<a id="tabl"><h2>Таблица наиболее часто встречающихся слов:</h2></a>
<table border="1">
	<tr>
		<td><center><B> Слова </B></center></td>
		<td><center><B> Количество повторений </B></center></td>
	</tr>
	<tr>
		<td> Числа(о) </td>
		<td> 64 </td>
	</tr>
	<tr>
		<td> Программа(ы) </td>
		<td> 28 </td>
	</tr>
	<tr>
		<td> End </td>
		<td> 18 </td>
	</tr>
	<tr>
		<td> Var </td>
		<td> 18 </td>
	</tr>
	<tr>
		<td> Begin </td>
		<td> 18 </td>
	</tr>
	<tr>
		<td> Цифра(ы) </td>
		<td> 18 </td>
	</tr>
	<tr>
		<td> Составить </td>
		<td> 15 </td>
	</tr>
	<tr>
		<td> Длинный </td>
		<td> 14 </td>
	</tr>
</table>
<CENTER>
<hr>
</center>
<a id="spisok"><h2>Список использованной литературы</h2></a>
<OL>
<LI>Абрамов С.А., Гнездилова Г.Г., Капустина Е.Н., Селюн М.И. Задачи по программированию. М.: Наука, 1988.</LI>
<LI>Олимпиады по информатике. Задачи и решения. Методические рекомендации для учителей и учащихся школ. Красноярск, 1991.</LI>
<LI>Пильщиков В.Н. Сборник упражнений по языку Паскаль. М.: Наука, 1989.</LI>
<LI>Касаткин В.Н. Информация. Алгоритмы. ЭВМ. М.: Просвещение, 1991. </LI>
<LI>Хонсбергер Р. Математические изюминки. М.: Наука, 1992.</LI>
<LI>Семакин И.Г., Шестаков А.П. Лекции по программированию. Пермь: изд-во ПГУ, 1998.</LI>
<LI>Гусев В.А., Мордкович А.Г. Математика. Справочные материалы. М.: Просвещение, 1990.</LI>
<LI>Гладков В.П. Курс лабораторных работ по программированию. Пермь: изд-во ПГТУ, 1998.</LI>
</OL>
<CENTER>
<hr>
</center>
<a id="staty"><h2>Похожие статьи:</h2></a>
<DL>
<LI><a href="#">https://lektsii.org/14-36325.html</a></LI>
<LI><a href="#">https://cyberpedia.su/4x2043.html</a></LI>
<LI><a href="#">https://acmp.ru/article.asp?id_text=1329</a></LI>
</DL><BR>
<CENTER>
<hr>
<P>&nbsp;</P>
</center>
<Font Size=1>&copy; Шестаков А.П., 1996-1999</Font>
</BODY>
</HTML>